---
layout: post
title: 要求の"自動修正"を安全に回すコツ
date: 2024-10-25
tags: [要求品質, 自動修正, 妥当性チェック]
---

## はじめに

要求管理MCPサーバーでは、**妥当性チェック**と**自動修正**を組み合わせることで、要求品質を機械的に維持します。本記事では、自動修正を安全に運用するためのポイントを解説します。

## 曖昧語の自動検出と具体化提案

### 検出対象の曖昧語

- 「なるべく」「できれば」「適切に」「十分な」
- 「など」（列挙の不完全性）
- 「必要に応じて」（条件が不明確）

### 具体化の例

**Before（曖昧）:**
```
システムは、適切なタイミングでユーザーに通知を送信する
```

**After（具体化）:**
```
システムは、データ更新から5分以内にユーザーにプッシュ通知を送信する
```

## Human-in-the-loop 承認フロー

自動修正は、以下の3ステップで安全性を担保します：

### 1. 修正案の生成（AI）

Validation Engineが問題を検出し、Fix Engineが修正案を生成。

### 2. プレビューと承認（人間）

修正案を人間が確認：
- **差分表示**: Before/Afterを明示
- **理由説明**: なぜこの修正が必要か
- **影響範囲**: 修正による波及効果

### 3. 適用とトレース更新（AI）

承認後、自動的に以下を実行：
- 要求データの更新
- 依存関係の再計算
- 変更履歴の記録
- トレーサビリティリンクの更新

## JSON形式でのデータ交換

修正結果はJSON形式で保存され、他のツールと連携可能です。

### エクスポート例

```json
{
  "id": "REQ-001",
  "title": "ユーザー通知機能",
  "description": "システムは、データ更新から5分以内にユーザーにプッシュ通知を送信する",
  "status": "approved",
  "修正履歴": [
    {
      "date": "2024-10-25",
      "type": "曖昧語具体化",
      "before": "適切なタイミングで",
      "after": "データ更新から5分以内に"
    }
  ]
}
```

## テスト管理との連携

修正された要求は、テストケースと自動リンクされます：

1. **受入条件の抽出**: 要求から観測可能な条件を抽出
2. **テストIDの紐付け**: 対応するテストケースにリンク
3. **影響範囲の通知**: 要求変更時、関連テストに自動通知

## まとめ

要求の自動修正は、以下の原則で安全に運用できます：

- ✅ **透明性**: すべての修正に理由と差分を記録
- ✅ **可逆性**: いつでもロールバック可能
- ✅ **承認フロー**: 人間が最終判断
- ✅ **トレーサビリティ**: テストやタスクとの連携を自動維持

次回は、**オントロジーのカスタマイズ方法**について解説します。

---

**関連リンク:**
- [GitHub リポジトリ](https://github.com/sawadari/requirements-mcp-server)
- [ランディングページ](https://sawadari.github.io/requirements-mcp-server/)
